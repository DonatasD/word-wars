var f=Object.defineProperty;var g=(o,t,e)=>t in o?f(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var i=(o,t,e)=>g(o,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();class p{constructor(t,e){i(this,"ctx");i(this,"inputStore");i(this,"limit");i(this,"padding");this.ctx=t,this.inputStore=e,this.padding=this.ctx.canvas.width*.1}draw(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.font="120px Serif",this.ctx.fillStyle="#ffffff",this.ctx.textBaseline="middle",this.ctx.textAlign="center",this.ctx.fillText(this.inputStore.getValue(),this.ctx.canvas.width/2,this.ctx.canvas.height/2)}setValue(t){const e=this.inputStore.getValue();(this.limit&&this.limit<e.length||e.length>t.length)&&(this.limit=void 0),this.limit||(this.ctx.measureText(t).width<=this.ctx.canvas.width-this.padding?this.setValue(t):this.limit=e.length)}}class m{constructor(t,e){i(this,"ctx");i(this,"img");this.ctx=t,this.img=e}draw(){this.ctx.drawImage(this.img,0,0,this.ctx.canvas.width,this.ctx.canvas.height)}}class w{constructor(t,e){i(this,"inputStore");i(this,"wordStore");this.inputStore=t,this.wordStore=e}init(){window.addEventListener("keypress",t=>{const e=this.inputStore.getValue();switch(t.key){case"Enter":{e.length>0&&(this.inputStore.setValue(""),this.wordStore.removeFirstByValue(e));break}case" ":break;default:t.key.length===1&&this.inputStore.setValue(e+t.key.toLowerCase())}}),window.addEventListener("keydown",t=>{switch(t.key){case"Backspace":{const e=this.inputStore.getValue();this.inputStore.setValue(e.substring(0,e.length-1));break}}})}}class y{constructor(t=""){i(this,"value");this.value=t}getValue(){return this.value}setValue(t){this.value=t}}const x="#ffff00",c="#ffffff",u=48,v="Serif",d=-10,l=10;class S{constructor(t,e,n,s){i(this,"position");i(this,"text");i(this,"styles");i(this,"velocity");this.position=t,this.text=e,this.styles=n,this.velocity=s}draw(t){let e=0;for(let n=0;n<this.text.length;n++){const{fontSize:s,fontFamily:r,color:a}=this.styles[n],h=this.text.charAt(n);t.font=`${s}px ${r}`,t.fillStyle=a,t.fillText(h,this.position.x+e,this.position.y),e+=t.measureText(h).width}}}class L{constructor(t,e=[]){i(this,"generator");i(this,"words");this.words=e,this.generator=t}removeFirstByValue(t){const e=this.words.findIndex(n=>n.text===t);e!=-1&&this.words.splice(e,1)}add(){const t=this.generator.generateWordText(),e=Array.from({length:t.length},()=>({fontSize:u,color:c,fontFamily:v})),n=new S(this.generator.generateWordPosition(),t,e,this.generator.generateWordVelocity());this.generator.generateWordText(),this.words.push(n)}getWords(){return this.words}}class I{constructor(t,e,n){i(this,"ctx");i(this,"wordStore");i(this,"inputStore");this.ctx=t,this.wordStore=e,this.inputStore=n}draw(){this.moveWords(),this.styleWords(),this.wordStore.getWords().forEach(t=>{t.draw(this.ctx)})}moveWords(){this.wordStore.getWords().forEach(t=>{const e=this.ctx.measureText(t.text).width,n=t.styles[0].fontSize;(t.position.x+e+t.velocity.x>this.ctx.canvas.width&&t.velocity.x>0||t.position.x<0&&t.velocity.x<0)&&(t.velocity.x*=-1),(t.position.y>this.ctx.canvas.height&&t.velocity.y>0||t.position.y<n&&t.velocity.y<0)&&(t.velocity.y*=-1),t.position.x+=t.velocity.x,t.position.y+=t.velocity.y})}styleWords(){const t=this.inputStore.getValue();this.wordStore.getWords().forEach(e=>{t&&e.text.startsWith(t)?e.styles=e.styles.map((s,r)=>({...s,color:r<t.length?x:c})):e.styles=e.styles.map(s=>({...s,color:c}))})}}class W{constructor(t){i(this,"ctx");i(this,"wordList");this.ctx=t,this.wordList=Object.keys({test:1})}generateWordText(){return this.wordList[Math.floor(Math.random()*this.wordList.length)]}generateWordPosition(t=u){return{x:this.generateRandomInt(0,this.ctx.canvas.width),y:this.generateRandomInt(t,this.ctx.canvas.height-t)}}generateWordVelocity(){return{x:this.generateRandomInt(d,l)||1,y:this.generateRandomInt(d,l)||1}}generateRandomInt(t=0,e){return Math.floor(Math.random()*e)+t}}class V{constructor(t=60){i(this,"now",performance.now());i(this,"fps");this.fps=t,this.now=performance.now()}isReady(){const t=performance.now();return performance.now()-this.now>1e3/this.fps?(this.now=t,!0):!1}}class b{constructor(){i(this,"canvasGame");i(this,"canvasInput");i(this,"wordDrawer");i(this,"input");i(this,"background");i(this,"keyboard");i(this,"frameLimiter");this.canvasGame=document.getElementById("word-wars-game"),this.canvasInput=document.getElementById("word-wars-user-input"),this.frameLimiter=new V,this.initCanvas();const t=this.canvasGame.getContext("2d");this.background=new m(t,document.getElementById("letofi"));const e=this.canvasInput.getContext("2d"),n=new y;this.input=new p(e,n);const s=new W(t),r=new L(s);this.wordDrawer=new I(t,r,n);for(let a=0;a<10;a++)r.add();this.keyboard=new w(n,r),this.init()}init(){this.keyboard.init(),window.addEventListener("resize",()=>{this.initCanvas()})}initCanvas(){this.canvasInput.width=window.innerWidth,this.canvasInput.height=200,this.canvasInput.style.background="#000000",this.canvasGame.width=window.innerWidth,this.canvasGame.height=window.innerHeight-200,this.canvasGame.style.background="#000000"}start(){this.frameLimiter.isReady()&&(this.background.draw(),this.wordDrawer.draw(),this.input.draw()),requestAnimationFrame(this.start.bind(this))}}const E=new b;E.start();
